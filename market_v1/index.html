<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Market v1.1</title>
    </head>
    <body></body>
    <script>
        // define semua variable dalam bentuk array
        let harga = [10000, 15000, 20000]
        let stock = [35, 40, 15]

        // define harga produk
        let hargaApple = 10000
        let hargaOrange = 15000
        let hargaGrape = 20000

        // define stock masing-masing produk
        let stockApple = 35
        let stockOrange = 40
        let stockGrape = 15

        main : while (true) {
            alert(`
                Selamat di toko ANDA
                1. Apple üçé Rp 10.000,00 /kg
                2. Orange üçä Rp 15.000,00 /kg
                3. Grape üçá RP 20.0000,00 /kg
            `)

            // define variable untuk menampung input dari user
            let qty = [0, 0, 0] // quantity
            let apple
            while (true) {
                apple = parseInt(prompt("Masukan total apple üçè yang ingin anda beli!"))        
                if (apple > stockApple) {
                    alert("input over stock üçé")
                } else if (isNaN(apple)) {
                    alert("‚ö† wrong input.")
                } else {
                    break
                }
            }
    
            let orange
            while (true) {
                orange = parseInt(prompt("Masukan total orange üçä yang ingin anda beli!"))
                if (orange > stockOrange) {
                    alert("input over stock üçä")
                } else if (isNaN(orange)) {
                    alert("‚ö† wrong input.")
                } else {
                    break
                }
            }
    
            let grape
            while (true) {
                grape = parseInt(prompt("Masukan total grape üçá yang ingin anda beli!"))
                if (grape > stockGrape) {
                    alert("input over stock üçá")
                } else if (isNaN(grape)) {
                    alert("‚ö† wrong input.")
                } else {
                    break
                }
            }
    
            // calculate total
            let total = [0, 0, 0]
            let totalBeliApple = apple * hargaApple
            let totalBeliOrange = orange * hargaOrange
            let totalBeliGrape = grape * hargaGrape
            let totalBelanja = totalBeliApple + totalBeliOrange + totalBeliGrape
    
            // tampilkan output : detail belanja
            alert(`
                Detail belanja
                Total apple üçè : ${apple} buah x ${hargaApple} = ${totalBeliApple}
                Total orange üçä : ${orange} buah x ${hargaOrange} = ${totalBeliOrange}
                Total grape üçá : ${grape} buah x ${hargaGrape} = ${totalBeliGrape}
                Total Belanja : ${totalBelanja}
            `)

            // minta input pembayaran
            let bayar
            while (true) {
                bayar = parseInt(prompt("Masukan uang anda !"))
                if (bayar < totalBelanja) {
                    alert("Maaf uang anda kurang")
                } else if (isNaN(bayar)) {
                    alert("‚ö† Wrong input !")
                } else {
                    break
                }
            }

            // check kembalian
            let kembalian = bayar - totalBelanja
            if (bayar > totalBelanja) {
                alert(`
                    Terima kasih sudah berbelanja di toko kami üôè
                    Uang kembalian : Rp ${kembalian},00 
                `)
            } else {
                alert("Terima kasih sudah berbelanja di toko kami üôè")
            }

            // kurangi stock
            stockApple -= apple
            stockOrange -= orange
            stockGrape -= grape

            // minta user confirmation
            let confirmation = confirm("Apakah anda ingin belanja lagi?")
            if (confirmation === false) {
                break main
            }
        }
    </script>
</html>